VERSION 5.00
Object = "{8C3D4AA0-2599-11D2-BAF1-00104B9E0792}#3.0#0"; "sssplt30.ocx"
Object = "{D1F54538-FC6B-4AC6-9655-2FB5170110A8}#1.0#0"; "Indate.ocx"
Object = "{FDAC2480-F4ED-4632-AA78-DCA210A74E49}#6.0#0"; "SPR32X60.ocx"
Begin VB.Form CGT2110C 
   Caption         =   "厚度公差达标率报表_CGT2110C"
   ClientHeight    =   9435
   ClientLeft      =   525
   ClientTop       =   1815
   ClientWidth     =   17235
   LinkTopic       =   "Form1"
   MDIChild        =   -1  'True
   ScaleHeight     =   9435
   ScaleWidth      =   17235
   WindowState     =   2  'Maximized
   Begin VB.TextBox txt_shape 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "宋体"
         Size            =   9.75
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3960
      MaxLength       =   3
      TabIndex        =   4
      Text            =   "ss1"
      Top             =   0
      Visible         =   0   'False
      Width           =   480
   End
   Begin SSSplitter.SSSplitter SSSplitter1 
      Height          =   8910
      Left            =   90
      TabIndex        =   0
      Top             =   465
      Width           =   17730
      _ExtentX        =   31274
      _ExtentY        =   15716
      _Version        =   196609
      SplitterBarWidth=   3
      SplitterBarJoinStyle=   0
      SplitterBarAppearance=   0
      BorderStyle     =   0
      BackColor       =   16761087
      PaneTree        =   "CGT2110C.frx":0000
      Begin FPSpread.vaSpread ss1 
         Height          =   2415
         Left            =   0
         TabIndex        =   2
         Top             =   0
         Width           =   8490
         _Version        =   393216
         _ExtentX        =   14975
         _ExtentY        =   4260
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowMultiBlocks=   -1  'True
         AllowUserFormulas=   -1  'True
         ColHeaderDisplay=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "宋体"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MaxCols         =   7
         MaxRows         =   1
         Protect         =   0   'False
         RetainSelBlock  =   0   'False
         SpreadDesigner  =   "CGT2110C.frx":0092
      End
      Begin FPSpread.vaSpread ss3 
         Height          =   3195
         Left            =   0
         TabIndex        =   3
         Top             =   2460
         Width           =   17730
         _Version        =   393216
         _ExtentX        =   31274
         _ExtentY        =   5636
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowMultiBlocks=   -1  'True
         AllowUserFormulas=   -1  'True
         ColHeaderDisplay=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "宋体"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MaxCols         =   34
         MaxRows         =   1
         Protect         =   0   'False
         RetainSelBlock  =   0   'False
         SpreadDesigner  =   "CGT2110C.frx":0600
      End
      Begin FPSpread.vaSpread ss2 
         Height          =   2415
         Left            =   8535
         TabIndex        =   5
         Top             =   0
         Width           =   9195
         _Version        =   393216
         _ExtentX        =   16219
         _ExtentY        =   4260
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowMultiBlocks=   -1  'True
         AllowUserFormulas=   -1  'True
         ColHeaderDisplay=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "宋体"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MaxCols         =   7
         MaxRows         =   1
         Protect         =   0   'False
         RetainSelBlock  =   0   'False
         SpreadDesigner  =   "CGT2110C.frx":1713
      End
      Begin FPSpread.vaSpread ss4 
         Height          =   3210
         Left            =   0
         TabIndex        =   6
         Top             =   5700
         Width           =   17730
         _Version        =   393216
         _ExtentX        =   31274
         _ExtentY        =   5662
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowMultiBlocks=   -1  'True
         AllowUserFormulas=   -1  'True
         ColHeaderDisplay=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "宋体"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MaxCols         =   34
         MaxRows         =   1
         Protect         =   0   'False
         RetainSelBlock  =   0   'False
         SpreadDesigner  =   "CGT2110C.frx":1C56
      End
   End
   Begin InDate.UDate txt_DATE 
      Height          =   315
      Left            =   1215
      TabIndex        =   1
      Tag             =   "起始日期"
      Top             =   105
      Width           =   1485
      _ExtentX        =   2619
      _ExtentY        =   556
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "宋体"
         Size            =   9.74
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      BackColor       =   16777215
   End
   Begin InDate.ULabel ULabel5 
      Height          =   315
      Left            =   90
      Top             =   105
      Width           =   1065
      _ExtentX        =   1879
      _ExtentY        =   556
      Caption         =   "日期"
      Alignment       =   1
      BackColor       =   14804173
      BackgroundStyle =   1
      ChiselText      =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "宋体"
         Size            =   9.76
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "CGT2110C"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

'-------------------------------------------------------------------------------
'-- PROGRAM HEADER  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
'-------------------------------------------------------------------------------
'-- System Name       NISCO Production Management System
'-- Sub_System Name   Steel Making System
'-- Program Name      PROD REPORT V1010
'-- Program ID        CGT2110C
'-- Designer          HANCHAO
'-- Coder             HANCHAO
'-- Date              2015.12.04
'-- Description
'-------------------------------------------------------------------------------
'-- UPDATE HISTORY  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
'-------------------------------------------------------------------------------
'-- VER   DATE     EDITOR       DESCRIPTION
'-------------------------------------------------------------------------------
'-- DECLARATION     ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
'-------------------------------------------------------------------------------

Public FormType As String           'Form Type
Public Toolbar_St As String         'Active Form ToolBar Setting
Public sAuthority As String         'Active Form Authority Setting

Dim pControl As New Collection      'Master Primary Key Collection
Dim nControl As New Collection      'Master Necessary Collection
Dim mControl As New Collection      'Master Maxlength check Collection
Dim iControl As New Collection      'Master Insert Collection
Dim rControl As New Collection      'Master Refer Collection
Dim cControl As New Collection      'Master Copy Collection
Dim aControl As New Collection      'Master -> Spread Collection
Dim lControl As New Collection      'Master Lock Collection

Dim pColumn1 As New Collection      'Spread Primary Key Collection
Dim nColumn1 As New Collection      'Spread necessary Column Collection
Dim mColumn1 As New Collection      'Spread Maxlength check Column Collection
Dim iColumn1 As New Collection      'Spread Insert Column Collection
Dim aColumn1 As New Collection      'Master -> Spread Column Collection
Dim lColumn1 As New Collection      'Spread Lock Column Collection

Dim pColumn2 As New Collection      'Spread Primary Key Collection
Dim nColumn2 As New Collection      'Spread necessary Column Collection
Dim mColumn2 As New Collection      'Spread Maxlength check Column Collection
Dim iColumn2 As New Collection      'Spread Insert Column Collection
Dim aColumn2 As New Collection      'Master -> Spread Column Collection
Dim lColumn2 As New Collection      'Spread Lock Column Collection

Dim pColumn3 As New Collection      'Spread Primary Key Collection
Dim nColumn3 As New Collection      'Spread necessary Column Collection
Dim mColumn3 As New Collection      'Spread Maxlength check Column Collection
Dim iColumn3 As New Collection      'Spread Insert Column Collection
Dim aColumn3 As New Collection      'Master -> Spread Column Collection
Dim lColumn3 As New Collection      'Spread Lock Column Collection


Dim pColumn4 As New Collection      'Spread Primary Key Collection
Dim nColumn4 As New Collection      'Spread necessary Column Collection
Dim mColumn4 As New Collection      'Spread Maxlength check Column Collection
Dim iColumn4 As New Collection      'Spread Insert Column Collection
Dim aColumn4 As New Collection      'Master -> Spread Column Collection
Dim lColumn4 As New Collection      'Spread Lock Column Collection


Dim Mc1 As New Collection           'Master Collection
Dim sc1 As New Collection           'Spread Collection
Dim sc2 As New Collection           'Spread Collection
Dim sc3 As New Collection           'Spread Collection
Dim sc4 As New Collection           'Spread Collection

Dim Proc_Sc As New Collection       'Spread Struc Collection
Dim iSumCol As New Collection

Dim lBlkcol1 As Long                'To Excel Block Col1
Dim lBlkcol2 As Long                'To Excel Block Col2
Dim lBlkrow1 As Long                'To Excel Block Row1
Dim lBlkrow2 As Long                'To Excel Block Row2

Const SS1_GROUP_CD = 1
Const SS1_EMP_CD = 2
Const SS1_STAND = 3
Const SS1_MILL_COUNT = 4
Const SS1_MILL_PASS_COUNT = 5
Const SS1_MILL_PASS_RATE = 6
Const SS1_MILL_RANKING = 7

Const SS2_GROUP_CD = 1
Const SS2_EMP_CD = 2
Const SS2_STAND = 3
Const SS2_MILL_COUNT = 4
Const SS2_MILL_PASS_COUNT = 5
Const SS2_MILL_PASS_RATE = 6
Const SS2_MILL_RANKING = 7



Const SS3_GROUP_CD = 1
Const SS3_EMP_CD = 2
Const SS3_MILL_COUNT_Q345 = 3
Const SS3_MILL_PASS_COUNT_Q345 = 4
Const SS3_MILL_PASS_RATE_Q345 = 5
Const SS3_MILL_RAKING_Q345 = 6
Const SS3_MILL_COUNT_Q390 = 7
Const SS3_MILL_PASS_COUNT_Q390 = 8
Const SS3_MILL_PASS_RATE_Q390 = 9
Const SS3_MILL_RAKING_Q390 = 10
Const SS3_MILL_COUNT_Q460 = 11
Const SS3_MILL_PASS_COUNT_Q460 = 12
Const SS3_MILL_PASS_RATE_Q460 = 13
Const SS3_MILL_RAKING_Q460 = 14
Const SS3_MILL_COUNT_AD = 15
Const SS3_MILL_PASS_COUNT_AD = 16
Const SS3_MILL_PASS_RATE_AD = 17
Const SS3_MILL_RAKING_AD = 18
Const SS3_MILL_COUNT_R = 19
Const SS3_MILL_PASS_COUNT_R = 20
Const SS3_MILL_PASS_RATE_R = 21
Const SS3_MILL_RAKING_R = 22
Const SS3_MILL_COUNT_X = 23
Const SS3_MILL_PASS_COUNT_X = 24
Const SS3_MILL_PASS_RATE_X = 25
Const SS3_MILL_RAKING_X = 26
Const SS3_MILL_COUNT_Q235 = 27
Const SS3_MILL_PASS_COUNT_Q235 = 28
Const SS3_MILL_PASS_RATE_Q235 = 29
Const SS3_MILL_RAKING_Q235 = 30
Const SS3_MILL_COUNT_A36 = 31
Const SS3_MILL_PASS_COUNT_A36 = 32
Const SS3_MILL_PASS_RATE_A36 = 33
Const SS3_MILL_RAKING_A36 = 34

Const SS4_GROUP_CD = 1
Const SS4_EMP_CD = 2
Const SS4_MILL_COUNT_Q345 = 3
Const SS4_MILL_PASS_COUNT_Q345 = 4
Const SS4_MILL_PASS_RATE_Q345 = 5
Const SS4_MILL_RAKING_Q345 = 6
Const SS4_MILL_COUNT_Q390 = 7
Const SS4_MILL_PASS_COUNT_Q390 = 8
Const SS4_MILL_PASS_RATE_Q390 = 9
Const SS4_MILL_RAKING_Q390 = 10
Const SS4_MILL_COUNT_Q460 = 11
Const SS4_MILL_PASS_COUNT_Q460 = 12
Const SS4_MILL_PASS_RATE_Q460 = 13
Const SS4_MILL_RAKING_Q460 = 14
Const SS4_MILL_COUNT_AD = 15
Const SS4_MILL_PASS_COUNT_AD = 16
Const SS4_MILL_PASS_RATE_AD = 17
Const SS4_MILL_RAKING_AD = 18
Const SS4_MILL_COUNT_R = 19
Const SS4_MILL_PASS_COUNT_R = 20
Const SS4_MILL_PASS_RATE_R = 21
Const SS4_MILL_RAKING_R = 22
Const SS4_MILL_COUNT_X = 23
Const SS4_MILL_PASS_COUNT_X = 24
Const SS4_MILL_PASS_RATE_X = 25
Const SS4_MILL_RAKING_X = 26
Const SS4_MILL_COUNT_Q235 = 27
Const SS4_MILL_PASS_COUNT_Q235 = 28
Const SS4_MILL_PASS_RATE_Q235 = 29
Const SS4_MILL_RAKING_Q235 = 30
Const SS4_MILL_COUNT_A36 = 31
Const SS4_MILL_PASS_COUNT_A36 = 32
Const SS4_MILL_PASS_RATE_A36 = 33
Const SS4_MILL_RAKING_A36 = 34




Private Sub Form_Define()
    Dim i As Integer
    
    'Form Type : Start , Master, Sheet, Msheet, PopSheet, Refer
    FormType = "Sheet"

    'Call Master_Collection("Control_Name", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "r(refer)", "a(append)", "l(lock)")
    Call Gp_Ms_Collection(txt_DATE, "p", "n", " ", " ", "r", " ", " ", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
    
    'MASTER Collection
    Mc1.Add Item:=pControl, Key:="pControl"
    Mc1.Add Item:=nControl, Key:="nControl"
    Mc1.Add Item:=mControl, Key:="mControl"
    Mc1.Add Item:=iControl, Key:="iControl"
    Mc1.Add Item:=rControl, Key:="rControl"
    Mc1.Add Item:=cControl, Key:="cControl"
    Mc1.Add Item:=aControl, Key:="aControl"
    Mc1.Add Item:=lControl, Key:="lControl"

    
    'Call Spread_Collection("Column_Num", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "a(append_down), "l(lock)")
    Call Gp_Sp_Collection(ss1, 1, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 2, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 3, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 4, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 5, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 6, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
    Call Gp_Sp_Collection(ss1, 7, " ", " ", " ", " ", " ", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)

    'Spread_Collection
    sc1.Add Item:=ss1, Key:="Spread"
    sc1.Add Item:="CGT2110C.P_REFER1", Key:="P-R"
    sc1.Add Item:=pColumn1, Key:="pColumn"
    sc1.Add Item:=nColumn1, Key:="nColumn"
    sc1.Add Item:=aColumn1, Key:="aColumn"
    sc1.Add Item:=mColumn1, Key:="mColumn"
    sc1.Add Item:=iColumn1, Key:="iColumn"
    sc1.Add Item:=lColumn1, Key:="lColumn"
    sc1.Add Item:=1, Key:="First"
    sc1.Add Item:=ss1.MaxRows, Key:="Last"

    Proc_Sc.Add Item:=sc1, Key:="Sc1"
    
    'Call Spread_Collection("Column_Num", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "a(append_down), "l(lock)")
    Call Gp_Sp_Collection(ss2, 1, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 2, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 3, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 4, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 5, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 6, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)
    Call Gp_Sp_Collection(ss2, 7, " ", " ", " ", " ", " ", "l", pColumn2, nColumn2, mColumn2, iColumn2, aColumn2, lColumn2)

    
    'Spread_Collection
    sc2.Add Item:=ss2, Key:="Spread"
    sc2.Add Item:="CGT2110C.P_REFER2", Key:="P-R"
    sc2.Add Item:=pColumn2, Key:="pColumn"
    sc2.Add Item:=nColumn2, Key:="nColumn"
    sc2.Add Item:=aColumn2, Key:="aColumn"
    sc2.Add Item:=mColumn2, Key:="mColumn"
    sc2.Add Item:=iColumn2, Key:="iColumn"
    sc2.Add Item:=lColumn2, Key:="lColumn"
    sc2.Add Item:=1, Key:="First"
    sc2.Add Item:=ss2.MaxRows, Key:="Last"

    Proc_Sc.Add Item:=sc2, Key:="Sc2"
    
    
    For i = 1 To ss3.MaxRows
    'Call Spread_Collection("Column_Num", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "a(append_down), "l(lock)")
    Call Gp_Sp_Collection(ss3, i, " ", " ", " ", " ", " ", "l", pColumn3, nColumn3, mColumn3, iColumn3, aColumn3, lColumn3)
    Next i


    
    'Spread_Collection
    sc3.Add Item:=ss3, Key:="Spread"
    sc3.Add Item:="CGT2110C.P_REFER3", Key:="P-R"
    sc3.Add Item:=pColumn3, Key:="pColumn"
    sc3.Add Item:=nColumn3, Key:="nColumn"
    sc3.Add Item:=aColumn3, Key:="aColumn"
    sc3.Add Item:=mColumn3, Key:="mColumn"
    sc3.Add Item:=iColumn3, Key:="iColumn"
    sc3.Add Item:=lColumn3, Key:="lColumn"
    sc3.Add Item:=1, Key:="First"
    sc3.Add Item:=ss3.MaxRows, Key:="Last"

    Proc_Sc.Add Item:=sc3, Key:="Sc3"
    
    
    For i = 1 To ss4.MaxRows
    'Call Spread_Collection("Column_Num", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "a(append_down), "l(lock)")
    Call Gp_Sp_Collection(ss4, i, " ", " ", " ", " ", " ", "l", pColumn4, nColumn4, mColumn4, iColumn4, aColumn4, lColumn4)
    Next i


    
    'Spread_Collection
    sc4.Add Item:=ss4, Key:="Spread"
    sc4.Add Item:="CGT2110C.P_REFER4", Key:="P-R"
    sc4.Add Item:=pColumn4, Key:="pColumn"
    sc4.Add Item:=nColumn4, Key:="nColumn"
    sc4.Add Item:=aColumn4, Key:="aColumn"
    sc4.Add Item:=mColumn4, Key:="mColumn"
    sc4.Add Item:=iColumn4, Key:="iColumn"
    sc4.Add Item:=lColumn4, Key:="lColumn"
    sc4.Add Item:=1, Key:="First"
    sc4.Add Item:=ss4.MaxRows, Key:="Last"

    Proc_Sc.Add Item:=sc4, Key:="Sc4"
    

    
    Me.KeyPreview = True
    Me.BackColor = &HE0E0E0
    
End Sub

'Private Sub Form_Activate()
'
'    Call MDIMain.FormMenuSetting(Me, FormType, Toolbar_St, sAuthority)
'
'End Sub

Private Sub Form_Activate()
     
    Call MDIMain.FormMenuSetting(Me, FormType, Toolbar_St, sAuthority)
    
    MDIMain.MenuTool.Buttons(7).Enabled = False    'Row Insert
    MDIMain.MenuTool.Buttons(8).Enabled = False    'Row Delete
    MDIMain.MenuTool.Buttons(9).Enabled = False    'Row Cancle
    MDIMain.MenuTool.Buttons(11).Enabled = False   'Copy
    MDIMain.MenuTool.Buttons(12).Enabled = False   'Paste

End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    
    If KeyAscii = KEY_RETURN Then
        KeyAscii = 0
        SendKeys "{TAB}"
    End If

End Sub

Private Sub Form_Load()

    Screen.MousePointer = vbHourglass
    
    sAuthority = Gf_Pgm_Authority(Me.Name)

    Call Form_Define
    Call MDIMain.FormMenuSetting(Me, FormType, "FS", sAuthority)
    
    MDIMain.MenuTool.Buttons(7).Enabled = False    'Row Insert
    MDIMain.MenuTool.Buttons(8).Enabled = False    'Row Delete
    MDIMain.MenuTool.Buttons(9).Enabled = False    'Row Cancle
    MDIMain.MenuTool.Buttons(11).Enabled = False   'Copy
    MDIMain.MenuTool.Buttons(12).Enabled = False   'Paste
    
    Call Gp_Ms_Cls(Mc1("rControl"))

    
    Call Gp_Ms_NeceColor(Mc1("nControl"))
    
    Call Gp_Sp_Setting(sc1.Item("Spread"), False)
    Call Gp_Sp_Setting(sc2.Item("Spread"), False)
    Call Gp_Sp_Setting(sc3.Item("Spread"), False)
    Call Gp_Sp_Setting(sc4.Item("Spread"), False)

    
    Call Gp_Sp_ReadOnlySet(sc1.Item("Spread"))
    Call Gp_Sp_ReadOnlySet(sc2.Item("Spread"))
    Call Gp_Sp_ReadOnlySet(sc3.Item("Spread"))
    Call Gp_Sp_ReadOnlySet(sc4.Item("Spread"))
    

    
    Call Gf_Sp_Cls(sc1)
    Call Gf_Sp_Cls(sc2)
    Call Gf_Sp_Cls(sc3)
    Call Gf_Sp_Cls(sc4)

    
    Call Gp_Spl_SizeGet(SSSplitter1, "C-System.INI", Me.Name, "H")
    
    Call Gp_Sp_ColGet(sc1.Item("Spread"), "C-System.INI", Me.Name)
    Call Gp_Sp_ColGet(sc2.Item("Spread"), "C-System.INI", Me.Name)
    Call Gp_Sp_ColGet(sc3.Item("Spread"), "C-System.INI", Me.Name)
    Call Gp_Sp_ColGet(sc4.Item("Spread"), "C-System.INI", Me.Name)
    
'    Call Gp_Sp_HdColColor(Proc_Sc("Sc1")("Spread"), 5)
'    Call Gp_Sp_HdColColor(Proc_Sc("Sc1")("Spread"), 7)
    'Call Gp_Sp_HdColColor(Proc_Sc("Sc1")("Spread"), 14)
    'Call Gp_Sp_HdColColor(Proc_Sc("Sc1")("Spread"), 15)
    
    Screen.MousePointer = vbDefault

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)

    If Gf_Sp_ProceExist(Proc_Sc("Sc1")("Spread")) Then
        Cancel = 1
        Exit Sub
    End If
    
'    Call Gp_Spl_SizeSet(SSSplitter1, "C-System.INI", Me.Name)
'
'    Call Gp_Sp_ColSet(sc1.Item("Spread"), "C-System.INI", Me.Name)
'    Call Gp_Sp_ColSet(sc2.Item("Spread"), "C-System.INI", Me.Name)

    
'    Set pContro1 = Nothing
'    Set nContro1 = Nothing
'    Set iContro1 = Nothing
'    Set rContro1 = Nothing
'    Set cContro1 = Nothing
'    Set aContro1 = Nothing
'    Set lContro1 = Nothing
'    Set mContro1 = Nothing
'
'    Set iColumn1 = Nothing
'    Set pColumn1 = Nothing
'    Set lColumn1 = Nothing
'    Set nColumn1 = Nothing
'    Set mColumn1 = Nothing
'    Set aColumn1 = Nothing
'
'    Set iColumn2 = Nothing
'    Set pColumn2 = Nothing
'    Set lColumn2 = Nothing
'    Set nColumn2 = Nothing
'    Set mColumn2 = Nothing
'    Set aColumn2 = Nothing
    

    
    Set Mc1 = Nothing
    Set sc1 = Nothing
    Set sc2 = Nothing
    Set sc3 = Nothing
    Set sc4 = Nothing
    Set Proc_Sc = Nothing
    
    Call MDIMain.FormMenuSetting(Me, "Start", Toolbar_St, "")
    
End Sub

Public Sub Spread_Can()

    Call Gp_Sp_Cancel(M_CN1, Proc_Sc("SC"))
      
End Sub

Public Sub Form_Cls()
    
    If Gf_Sp_Cls(sc2) And Gf_Sp_Cls(sc1) And Gf_Sp_Cls(sc3) And Gf_Sp_Cls(sc4) Then
            Call Gp_Ms_Cls(Mc1("rControl"))
    End If
    
End Sub

Public Sub Form_Ref()

Dim GROUP_CD        As String
Dim GROUP_T         As String
Dim MILL_STAND      As String
Dim EMP_CD          As String
Dim iCount          As Integer
Dim iRow            As Integer
Dim mRow            As Integer
Dim T_GROUP_CD      As String
Dim T_EMP_CD        As String
Dim T_MILL_STAND    As String
Dim MILL_COUNT      As Integer
Dim MILL_PASS_COUNT As Integer
Dim MILL_COUNT_1        As Integer
Dim MILL_PASS_COUNT_1   As Integer
Dim MILL_COUNT_2        As Integer
Dim MILL_PASS_COUNT_2   As Integer
Dim MILL_COUNT_ALL_1      As Integer
Dim MILL_PASS_COUNT_ALL_1 As Integer
Dim MILL_COUNT_ALL_2      As Integer
Dim MILL_PASS_COUNT_ALL_2 As Integer
Dim MILL_PASS_RATE        As Double
Dim EMP1(100)             As Double
Dim EMP2(100)             As Double
Dim EMP3(100)             As Double
Dim EMP4(100)             As Double
Dim EMP5(100)             As Double
Dim EMP6(100)             As Double
Dim EMP7(100)             As Double
Dim EMP8(100)             As Double
Dim i                      As Integer
Dim j                      As Integer
Dim temp1                  As Double
Dim temp2                  As Double
Dim temp3                  As Double
Dim temp4                  As Double
Dim temp5                  As Double
Dim temp6                  As Double
Dim n1                     As Integer
Dim n2                     As Integer
Dim n3                     As Integer
Dim n4                     As Integer
Dim n5                     As Integer
Dim n6                     As Integer
Dim n7                     As Integer
Dim n8                     As Integer
Dim STLGRT_WGT_Q345             As Double
Dim STLGRT_PASS_WGT_Q345        As Double
Dim STLGRT_WGT_Q390             As Double
Dim STLGRT_PASS_WGT_Q390        As Double
Dim STLGRT_WGT_Q460             As Double
Dim STLGRT_PASS_WGT_Q460        As Double
Dim STLGRT_WGT_AD               As Double
Dim STLGRT_PASS_WGT_AD          As Double
Dim STLGRT_WGT_R                As Double
Dim STLGRT_PASS_WGT_R           As Double
Dim STLGRT_WGT_X                As Double
Dim STLGRT_PASS_WGT_X           As Double
Dim STLGRT_WGT_Q235             As Double
Dim STLGRT_PASS_WGT_Q235        As Double
Dim STLGRT_WGT_A36              As Double
Dim STLGRT_PASS_WGT_A36         As Double
Dim MILL_PASS_RATE_Q345         As Double
Dim MILL_PASS_RATE_Q390         As Double
Dim MILL_PASS_RATE_Q460         As Double
Dim MILL_PASS_RATE_AD         As Double
Dim MILL_PASS_RATE_R         As Double
Dim MILL_PASS_RATE_X         As Double
Dim MILL_PASS_RATE_Q235         As Double
Dim MILL_PASS_RATE_A36         As Double




       
    

    
    
    Call Gf_Sp_Refer(M_CN1, sc1, Mc1, Mc1("nControl"), Mc1("mControl"))
        ss1.OperationMode = OperationModeNormal

        Call Gf_Sp_Refer(M_CN1, sc2, Mc1, Mc1("nControl"), Mc1("mControl"), False)
        ss2.OperationMode = OperationModeNormal
        
        Call Gf_Sp_Refer(M_CN1, sc3, Mc1, Mc1("nControl"), Mc1("mControl"), False)
        ss3.OperationMode = OperationModeNormal
        
        Call Gf_Sp_Refer(M_CN1, sc4, Mc1, Mc1("nControl"), Mc1("mControl"), False)
        ss4.OperationMode = OperationModeNormal
        
        
        
 With ss1
        If .MaxRows < 1 Then
           Exit Sub
        End If
        
    T_EMP_CD = "当日"
'下面代码用于添加班组合计内容
'读取最大行数
         mRow = .MaxRows
'甲乙丙三班分别添加两行，因此总行数增加6行 实绩调试过程中发现FOR循环中的最大行数变量不会自动变化因此终结循环方式在循环体中控制
         mRow = 1000 'mRow + 6
'执行循环添加列
        For iCount = 1 To mRow
'当前行取循环行
        .ROW = iCount
'第一行的时候取出班组用于比较不同的时候添加
        If iCount = 1 Then
        
        .Col = 1:           GROUP_CD = .Text: GROUP_T = .Text

'其他行取出列
        
        Else
        
        .ROW = iCount
        .Col = 1:           GROUP_CD = .Text
        
        If GROUP_CD <> GROUP_T Then
        
         GROUP_T = GROUP_CD
         
         iRow = iCount - 1
         
         
         .ROW = iRow
         
'-----------------------------------
         
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
       
        .ROW = iRow
        .Col = SS1_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 1
        .Col = SS1_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS1_EMP_CD:   .Text = T_EMP_CD
        .Col = SS1_STAND:    .Text = "<23"
        
        
'----------------------------------
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
        
        .ROW = .ROW + 1
        

        .Action = 7
        .ReDraw = True
        
        
        .ROW = iRow
        .Col = SS1_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 2
        .Col = SS1_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS1_EMP_CD:   .Text = T_EMP_CD
        .Col = SS1_STAND:    .Text = ">=23"

        
        iCount = iCount + 2
        
        
        End If
        
        
        End If
        
        If iCount = .MaxRows Then
        
        Exit For
         
        End If
        Next iCount
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 2
        .ROW = .ROW + 2
        
        'Row = 0 is Default = 1

        .Action = 7
        .ReDraw = True
        
         iRow = .MaxRows
         iRow = iRow - 2
         
        .ROW = iRow
        .Col = SS1_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 1
        .Col = SS1_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS1_EMP_CD:   .Text = T_EMP_CD
        .Col = SS1_STAND:    .Text = "<23"
        
        
        .ROW = iRow + 2
        .Col = SS1_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS1_EMP_CD:   .Text = T_EMP_CD
        .Col = SS1_STAND:    .Text = ">=23"
        
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 2
        .ROW = .ROW + 2
        
        'Row = 0 is Default = 1

        .Action = 7
        .ReDraw = True
        
         iRow = .MaxRows
         iRow = iRow - 2
         
        .ROW = iRow + 1
        .Col = SS1_GROUP_CD: .Text = "全厂"
        .Col = SS1_EMP_CD:   .Text = "全厂"
        .Col = SS1_STAND:    .Text = "<23"
        
        
        .ROW = iRow + 2
        .Col = SS1_GROUP_CD: .Text = "全厂"
        .Col = SS1_EMP_CD:   .Text = "全厂"
        .Col = SS1_STAND:    .Text = ">=23"
        
        
        '下面代码用于添加当日累计内容
'读取最大行数
         mRow = .MaxRows
'甲乙丙三班分别添加两行，因此总行数增加6行
         mRow = 1000 'mRow + 6
'执行循环添加列
        For iCount = 1 To mRow
'当前行取循环行
        .ROW = iCount
'第一行的时候取出班组用于比较不同的时候添加

   If iCount = 1 Then
   
   .Col = SS1_EMP_CD:       EMP_CD = .Text: T_EMP_CD = .Text
   
   Else

   .Col = SS1_EMP_CD:       EMP_CD = .Text
   
   .ROW = iCount - 1
   
   .Col = SS1_EMP_CD:       T_EMP_CD = .Text
   
   If EMP_CD <> T_EMP_CD Then
   
   
   .Col = SS1_GROUP_CD: GROUP_CD = .Text
   .Col = SS1_EMP_CD: EMP_CD = .Text
    MILL_STAND = "当日累计"
   
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
        .Col = SS1_GROUP_CD: .Text = GROUP_CD
        .Col = SS1_EMP_CD: .Text = EMP_CD
        .Col = SS1_STAND: .Text = MILL_STAND
        
        iCount = iCount + 1
        
   End If
   
   
   
   End If
   
   
    If iCount = .MaxRows Then
        
        Exit For
         
        End If
        
        
        Next iCount
        
         .ROW = .MaxRows
         .Col = SS1_GROUP_CD: GROUP_CD = .Text
         .Col = SS1_EMP_CD: EMP_CD = .Text
          MILL_STAND = "当日累计"
   
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
        .Col = SS1_GROUP_CD: .Text = GROUP_CD
        .Col = SS1_EMP_CD: .Text = EMP_CD
        .Col = SS1_STAND: .Text = MILL_STAND
        
        
        
        
        MILL_COUNT_1 = 0
        MILL_COUNT_2 = 0
        MILL_PASS_COUNT_1 = 0
        MILL_PASS_COUNT_2 = 0
        
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        
        .Col = SS1_STAND:  MILL_STAND = .Text
        .Col = SS1_EMP_CD: EMP_CD = .Text
        
        .Col = SS1_MILL_COUNT: MILL_COUNT = Val(.Text)
    
        .Col = SS1_MILL_PASS_COUNT: MILL_PASS_COUNT = Val(.Text)
        
        If MILL_STAND = "<23" And EMP_CD <> "当日" And EMP_CD <> "全厂" Then
        
        MILL_COUNT_1 = MILL_COUNT_1 + MILL_COUNT
        
        MILL_PASS_COUNT_1 = MILL_PASS_COUNT_1 + MILL_PASS_COUNT
        
        ElseIf MILL_STAND = ">=23" And EMP_CD <> "当日" And EMP_CD <> "全厂" Then
        
        MILL_COUNT_2 = MILL_COUNT_2 + MILL_COUNT
        
        MILL_PASS_COUNT_2 = MILL_PASS_COUNT_2 + MILL_PASS_COUNT
        
        ElseIf MILL_STAND = "<23" And EMP_CD = "当日" Then
                
        .Col = SS1_MILL_COUNT: .Text = MILL_COUNT_1
        .Col = SS1_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_1
         MILL_COUNT_ALL_1 = MILL_COUNT_ALL_1 + MILL_COUNT_1
         MILL_PASS_COUNT_ALL_1 = MILL_PASS_COUNT_ALL_1 + MILL_PASS_COUNT_1
        
         
         MILL_COUNT_1 = 0
         MILL_PASS_COUNT_1 = 0
        
        ElseIf MILL_STAND = ">=23" And EMP_CD = "当日" Then
        
        .Col = SS1_MILL_COUNT: .Text = MILL_COUNT_2
        .Col = SS1_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_2
        
         MILL_COUNT_ALL_2 = MILL_COUNT_ALL_2 + MILL_COUNT_2
         MILL_PASS_COUNT_ALL_2 = MILL_PASS_COUNT_ALL_2 + MILL_PASS_COUNT_2
        
         MILL_COUNT_2 = 0
         MILL_PASS_COUNT_2 = 0
         
         ElseIf MILL_STAND = "<23" And EMP_CD = "全厂" Then
         
        .Col = SS1_MILL_COUNT: .Text = MILL_COUNT_ALL_1
        .Col = SS1_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_ALL_1
        
        ElseIf MILL_STAND = ">=23" And EMP_CD = "全厂" Then
         
        .Col = SS1_MILL_COUNT: .Text = MILL_COUNT_ALL_2
        .Col = SS1_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_ALL_2
         
        End If
        
        Next iCount
        
        
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        .Col = SS1_STAND: MILL_STAND = .Text
        If MILL_STAND = "当日累计" Then
        .ROW = iCount - 1
        .Col = SS1_MILL_COUNT: MILL_COUNT_1 = Val(.Text)
        .Col = SS1_MILL_PASS_COUNT: MILL_PASS_COUNT_1 = Val(.Text)
        .ROW = iCount - 2
        .Col = SS1_MILL_COUNT: MILL_COUNT_2 = Val(.Text)
        .Col = SS1_MILL_PASS_COUNT: MILL_PASS_COUNT_2 = Val(.Text)

        .ROW = iCount
         MILL_COUNT = MILL_COUNT_1 + MILL_COUNT_2
         MILL_PASS_COUNT = MILL_PASS_COUNT_1 + MILL_PASS_COUNT_2

        .Col = SS1_MILL_COUNT: .Text = MILL_COUNT
        .Col = SS1_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT

        End If

        Next iCount
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        .Col = SS1_MILL_COUNT: MILL_COUNT = Val(.Text)
        .Col = SS1_MILL_PASS_COUNT: MILL_PASS_COUNT = Val(.Text)
        
        If MILL_COUNT > 0 Then
        .Col = SS1_MILL_PASS_RATE: .Text = MILL_PASS_COUNT / MILL_COUNT * 100
        Else
        .Col = SS1_MILL_PASS_RATE: .Text = 0
        End If
        
        Next iCount
        
        


        
        
        
        '数组赋值
        
        n1 = 0
        For iCount = 1 To .MaxRows

        .ROW = iCount


        .Col = SS1_GROUP_CD: GROUP_CD = .Text
        .Col = SS1_EMP_CD: EMP_CD = .Text
        .Col = SS1_STAND: MILL_STAND = .Text
        .Col = SS1_MILL_PASS_RATE: MILL_PASS_RATE = Val(.Text)
  
'1
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "<23" Then

        EMP1(n1) = MILL_PASS_RATE
        
        n1 = n1 + 1

        End If
        
  '2
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = ">=23" Then

        
        EMP2(n2) = MILL_PASS_RATE
        
        n2 = n2 + 1
        

        End If
        
        
    '3
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "当日累计" Then

 
        EMP3(n3) = MILL_PASS_RATE
        
        n3 = n3 + 1

        End If
        
     '4
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "<23" Then

        EMP4(n4) = MILL_PASS_RATE
        
        n4 = n4 + 1

        End If
        
      '5
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = ">=23" Then

        EMP5(n5) = MILL_PASS_RATE
        
        n5 = n5 + 1

        End If
        
        
       '6
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "当日累计" Then

 
        EMP6(n6) = MILL_PASS_RATE
        
        n6 = n6 + 1

        End If
        
        Next iCount
         
         '个人排序
        
         For i = 0 To n1 - 2
        For j = 0 To n1 - 2 - i
        
        If EMP1(j) < EMP1(j + 1) Then
        
       temp1 = EMP1(j + 1): EMP1(j + 1) = EMP1(j): EMP1(j) = temp1
        
        End If
        
        Next j
        
        Next i
        
        For i = 0 To n2 - 2
        For j = 0 To n2 - 2 - i
        
        If EMP2(j) < EMP2(j + 1) Then
        
       temp2 = EMP2(j + 1): EMP2(j + 1) = EMP2(j): EMP2(j) = temp2
        
        End If
        
        Next j
        
        Next i
        
        For i = 0 To n3 - 2
        For j = 0 To n3 - 2 - i
        
        If EMP3(j) < EMP3(j + 1) Then
        
       temp3 = EMP3(j + 1): EMP3(j + 1) = EMP3(j): EMP3(j) = temp3
        
        End If

        
        Next j
        
        Next i
        
        
        '当日统计排序
        For i = 0 To n6 - 2
        For j = 0 To n6 - 2 - i
        
        If EMP4(j) < EMP4(j + 1) Then
        
       temp4 = EMP4(j + 1): EMP4(j + 1) = EMP4(j): EMP4(j) = temp4
        
        End If
        
        If EMP5(j) < EMP5(j + 1) Then
        
       temp5 = EMP5(j + 1): EMP5(j + 1) = EMP5(j): EMP5(j) = temp5
        
        End If
        
        If EMP6(j) < EMP6(j + 1) Then
        
       temp6 = EMP6(j + 1): EMP6(j + 1) = EMP6(j): EMP6(j) = temp6
        
        End If

        
        Next j
        
        Next i
        

        

        
        '表单名次赋值
        For iCount = 1 To .MaxRows
        
        .ROW = iCount
        .Col = SS1_GROUP_CD: GROUP_CD = .Text
        .Col = SS1_EMP_CD: EMP_CD = .Text
        .Col = SS1_STAND: MILL_STAND = .Text
        .Col = SS1_MILL_PASS_RATE: MILL_PASS_RATE = Val(.Text)
        .Col = SS1_MILL_RANKING
        
        '条件1
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "<23" Then
        
        For i = n1 To 0 Step -1

        If MILL_PASS_RATE = EMP1(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = ">=23" Then
        
        For i = n2 To 0 Step -1

        If MILL_PASS_RATE = EMP2(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        '3
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "当日累计" Then
        
        For i = n3 To 0 Step -1

        If MILL_PASS_RATE = EMP3(i) Then

        .Text = i + 1

        End If
        
         Next i
        
        End If
        
           
     '4
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "<23" And MILL_PASS_RATE > 0 Then
        
        For i = n4 To 0 Step -1

        If MILL_PASS_RATE = EMP4(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
         '5
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = ">=23" And MILL_PASS_RATE > 0 Then

        
        For i = n5 To 0 Step -1

        If MILL_PASS_RATE = EMP5(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        '6
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "当日累计" And MILL_PASS_RATE > 0 Then

        
        For i = n6 To 0 Step -1

        If MILL_PASS_RATE = EMP6(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        Next iCount
        
        End With
        
        
        
        
Erase EMP1
Erase EMP2
Erase EMP3
Erase EMP4
Erase EMP5
Erase EMP6
n1 = 0
n2 = 0
n3 = 0
n4 = 0
n5 = 0
n6 = 0
        
        
        
        
        
        
         With ss2
        If .MaxRows < 1 Then
           Exit Sub
        End If
        
    T_EMP_CD = "当日"
'下面代码用于添加班组合计内容
'读取最大行数
         mRow = .MaxRows
'甲乙丙三班分别添加两行，因此总行数增加6行 实绩调试过程中发现FOR循环中的最大行数变量不会自动变化因此终结循环方式在循环体中控制
         mRow = 1000 'mRow + 6
'执行循环添加列
        For iCount = 1 To mRow
'当前行取循环行
        .ROW = iCount
'第一行的时候取出班组用于比较不同的时候添加
        If iCount = 1 Then
        
        .Col = 1:           GROUP_CD = .Text: GROUP_T = .Text

'其他行取出列
        
        Else
        
        .ROW = iCount
        .Col = 1:           GROUP_CD = .Text
        
        If GROUP_CD <> GROUP_T Then
        
         GROUP_T = GROUP_CD
         
         iRow = iCount - 1
         
         
         .ROW = iRow
         
'-----------------------------------
         
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
       
        .ROW = iRow
        .Col = SS2_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 1
        .Col = SS2_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS2_EMP_CD:   .Text = T_EMP_CD
        .Col = SS2_STAND:    .Text = "<23"
        
        
'----------------------------------
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
        
        .ROW = .ROW + 1
        

        .Action = 7
        .ReDraw = True
        
        
        .ROW = iRow
        .Col = SS2_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 2
        .Col = SS2_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS2_EMP_CD:   .Text = T_EMP_CD
        .Col = SS2_STAND:    .Text = ">=23"

        
        iCount = iCount + 2
        
        
        End If
        
        
        End If
        
        If iCount = .MaxRows Then
        
        Exit For
         
        End If
        Next iCount
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 2
        .ROW = .ROW + 2
        
        'Row = 0 is Default = 1

        .Action = 7
        .ReDraw = True
        
         iRow = .MaxRows
         iRow = iRow - 2
         
        .ROW = iRow
        .Col = SS2_GROUP_CD: T_GROUP_CD = .Text
        .ROW = iRow + 1
        .Col = SS2_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS2_EMP_CD:   .Text = T_EMP_CD
        .Col = SS2_STAND:    .Text = "<23"
        
        
        .ROW = iRow + 2
        .Col = SS2_GROUP_CD: .Text = T_GROUP_CD
        .Col = SS2_EMP_CD:   .Text = T_EMP_CD
        .Col = SS2_STAND:    .Text = ">=23"
        
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 2
        .ROW = .ROW + 2
        
        'Row = 0 is Default = 1

        .Action = 7
        .ReDraw = True
        
         iRow = .MaxRows
         iRow = iRow - 2
         
        .ROW = iRow + 1
        .Col = SS2_GROUP_CD: .Text = "全厂"
        .Col = SS2_EMP_CD:   .Text = "全厂"
        .Col = SS2_STAND:    .Text = "<23"
        
        
        .ROW = iRow + 2
        .Col = SS2_GROUP_CD: .Text = "全厂"
        .Col = SS2_EMP_CD:   .Text = "全厂"
        .Col = SS2_STAND:    .Text = ">=23"
        
        
        '下面代码用于添加当日累计内容
'读取最大行数
         mRow = .MaxRows
'甲乙丙三班分别添加两行，因此总行数增加6行
         mRow = 1000 'mRow + 6
'执行循环添加列
        For iCount = 1 To mRow
'当前行取循环行
        .ROW = iCount
'第一行的时候取出班组用于比较不同的时候添加

   If iCount = 1 Then
   
   .Col = SS2_EMP_CD:       EMP_CD = .Text: T_EMP_CD = .Text
   
   Else

   .Col = SS2_EMP_CD:       EMP_CD = .Text
   
   .ROW = iCount - 1
   
   .Col = SS2_EMP_CD:       T_EMP_CD = .Text
   
   If EMP_CD <> T_EMP_CD Then
   
   
   .Col = SS2_GROUP_CD: GROUP_CD = .Text
   .Col = SS2_EMP_CD: EMP_CD = .Text
    MILL_STAND = "当日累计"
   
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
        .Col = SS2_GROUP_CD: .Text = GROUP_CD
        .Col = SS2_EMP_CD: .Text = EMP_CD
        .Col = SS2_STAND: .Text = MILL_STAND
        
        iCount = iCount + 1
        
   End If
   
   
   
   End If
   
   
    If iCount = .MaxRows Then
        
        Exit For
         
        End If
        
        
        Next iCount
        
         .ROW = .MaxRows
         .Col = SS2_GROUP_CD: GROUP_CD = .Text
         .Col = SS2_EMP_CD: EMP_CD = .Text
          MILL_STAND = "当日累计"
   
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        
        .Col = SS2_GROUP_CD: .Text = GROUP_CD
        .Col = SS2_EMP_CD: .Text = EMP_CD
        .Col = SS2_STAND: .Text = MILL_STAND
        
        
        
        
        MILL_COUNT_1 = 0
        MILL_COUNT_2 = 0
        MILL_PASS_COUNT_1 = 0
        MILL_PASS_COUNT_2 = 0
        
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        
        .Col = SS2_STAND:  MILL_STAND = .Text
        .Col = SS2_EMP_CD: EMP_CD = .Text
        
        .Col = SS2_MILL_COUNT: MILL_COUNT = Val(.Text)
    
        .Col = SS2_MILL_PASS_COUNT: MILL_PASS_COUNT = Val(.Text)
        
        If MILL_STAND = "<23" And EMP_CD <> "当日" And EMP_CD <> "全厂" Then
        
        MILL_COUNT_1 = MILL_COUNT_1 + MILL_COUNT
        
        MILL_PASS_COUNT_1 = MILL_PASS_COUNT_1 + MILL_PASS_COUNT
        
        ElseIf MILL_STAND = ">=23" And EMP_CD <> "当日" And EMP_CD <> "全厂" Then
        
        MILL_COUNT_2 = MILL_COUNT_2 + MILL_COUNT
        
        MILL_PASS_COUNT_2 = MILL_PASS_COUNT_2 + MILL_PASS_COUNT
        
        ElseIf MILL_STAND = "<23" And EMP_CD = "当日" Then
                
        .Col = SS2_MILL_COUNT: .Text = MILL_COUNT_1
        .Col = SS2_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_1
         MILL_COUNT_ALL_1 = MILL_COUNT_ALL_1 + MILL_COUNT_1
         MILL_PASS_COUNT_ALL_1 = MILL_PASS_COUNT_ALL_1 + MILL_PASS_COUNT_1
        
         
         MILL_COUNT_1 = 0
         MILL_PASS_COUNT_1 = 0
        
        ElseIf MILL_STAND = ">=23" And EMP_CD = "当日" Then
        
        .Col = SS2_MILL_COUNT: .Text = MILL_COUNT_2
        .Col = SS2_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_2
        
         MILL_COUNT_ALL_2 = MILL_COUNT_ALL_2 + MILL_COUNT_2
         MILL_PASS_COUNT_ALL_2 = MILL_PASS_COUNT_ALL_2 + MILL_PASS_COUNT_2
        
         MILL_COUNT_2 = 0
         MILL_PASS_COUNT_2 = 0
         
         ElseIf MILL_STAND = "<23" And EMP_CD = "全厂" Then
         
        .Col = SS2_MILL_COUNT: .Text = MILL_COUNT_ALL_1
        .Col = SS2_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_ALL_1
        
        ElseIf MILL_STAND = ">=23" And EMP_CD = "全厂" Then
         
        .Col = SS2_MILL_COUNT: .Text = MILL_COUNT_ALL_2
        .Col = SS2_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT_ALL_2
         
        End If
        
        Next iCount
        
        
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        .Col = SS2_STAND: MILL_STAND = .Text
        If MILL_STAND = "当日累计" Then
        .ROW = iCount - 1
        .Col = SS2_MILL_COUNT: MILL_COUNT_1 = Val(.Text)
        .Col = SS2_MILL_PASS_COUNT: MILL_PASS_COUNT_1 = Val(.Text)
        .ROW = iCount - 2
        .Col = SS2_MILL_COUNT: MILL_COUNT_2 = Val(.Text)
        .Col = SS2_MILL_PASS_COUNT: MILL_PASS_COUNT_2 = Val(.Text)

        .ROW = iCount
         MILL_COUNT = MILL_COUNT_1 + MILL_COUNT_2
         MILL_PASS_COUNT = MILL_PASS_COUNT_1 + MILL_PASS_COUNT_2

        .Col = SS2_MILL_COUNT: .Text = MILL_COUNT
        .Col = SS2_MILL_PASS_COUNT: .Text = MILL_PASS_COUNT

        End If

        Next iCount
        
        For iCount = 1 To .MaxRows
        .ROW = iCount
        .Col = SS2_MILL_COUNT: MILL_COUNT = Val(.Text)
        .Col = SS2_MILL_PASS_COUNT: MILL_PASS_COUNT = Val(.Text)
        
        If MILL_COUNT > 0 Then
                temp1 = MILL_PASS_COUNT / MILL_COUNT * 100
        .Col = SS2_MILL_PASS_RATE: .Text = MILL_PASS_COUNT / MILL_COUNT * 100
        Else
        .Col = SS2_MILL_PASS_RATE: .Text = 0
        End If
        
        Next iCount
        
        


        
        
        
        '数组赋值
        
        n1 = 0
        For iCount = 1 To .MaxRows

        .ROW = iCount


        .Col = SS2_GROUP_CD: GROUP_CD = .Text
        .Col = SS2_EMP_CD: EMP_CD = .Text
        .Col = SS2_STAND: MILL_STAND = .Text
        .Col = SS2_MILL_PASS_RATE: MILL_PASS_RATE = Val(.Text)
  
'1
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "<23" Then

        EMP1(n1) = MILL_PASS_RATE
        
        n1 = n1 + 1

        End If
        
  '2
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = ">=23" Then

        
        EMP2(n2) = MILL_PASS_RATE
        
        n2 = n2 + 1
        

        End If
        
        
    '3
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "当日累计" Then

 
        EMP3(n3) = MILL_PASS_RATE
        
        n3 = n3 + 1

        End If
        
     '4
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "<23" Then

        EMP4(n4) = MILL_PASS_RATE
        
        n4 = n4 + 1

        End If
        
      '5
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = ">=23" Then

        EMP5(n5) = MILL_PASS_RATE
        
        n5 = n5 + 1

        End If
        
        
       '6
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "当日累计" Then

 
        EMP6(n6) = MILL_PASS_RATE
        
        n6 = n6 + 1

        End If
        
        Next iCount
         
         '个人排序
        
        For i = 0 To n1 - 2
        For j = 0 To n1 - 2 - i
        
        If EMP1(j) < EMP1(j + 1) Then
        
       temp1 = EMP1(j + 1): EMP1(j + 1) = EMP1(j): EMP1(j) = temp1
        
        End If
        
        Next j
        
        Next i
        
        For i = 0 To n2 - 2
        For j = 0 To n2 - 2 - i
        
        If EMP2(j) < EMP2(j + 1) Then
        
       temp2 = EMP2(j + 1): EMP2(j + 1) = EMP2(j): EMP2(j) = temp2
        
        End If
        
        Next j
        
        Next i
        
        For i = 0 To n3 - 2
        For j = 0 To n3 - 2 - i
        
        If EMP3(j) < EMP3(j + 1) Then
        
       temp3 = EMP3(j + 1): EMP3(j + 1) = EMP3(j): EMP3(j) = temp3
        
        End If

        
        Next j
        
        Next i
        
        
        '当日统计排序
        For i = 0 To n6 - 2
        For j = 0 To n6 - 2 - i
        
        If EMP4(j) < EMP4(j + 1) Then
        
       temp4 = EMP4(j + 1): EMP4(j + 1) = EMP4(j): EMP4(j) = temp4
        
        End If
        
        If EMP5(j) < EMP5(j + 1) Then
        
       temp5 = EMP5(j + 1): EMP5(j + 1) = EMP5(j): EMP5(j) = temp5
        
        End If
        
        If EMP6(j) < EMP6(j + 1) Then
        
       temp6 = EMP6(j + 1): EMP6(j + 1) = EMP6(j): EMP6(j) = temp6
        
        End If

        
        Next j
        
        Next i
        
        
        '表单名次赋值
        For iCount = 1 To .MaxRows
        
        .ROW = iCount
        .Col = SS2_GROUP_CD: GROUP_CD = .Text
        .Col = SS2_EMP_CD: EMP_CD = .Text
        .Col = SS2_STAND: MILL_STAND = .Text
        .Col = SS2_MILL_PASS_RATE: MILL_PASS_RATE = Val(.Text)
        .Col = SS2_MILL_RANKING
        
        '条件1
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "<23" Then
        
        For i = n1 To 0 Step -1

        If MILL_PASS_RATE = EMP1(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = ">=23" Then
        
        For i = n2 To 0 Step -1

        If MILL_PASS_RATE = EMP2(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        '3
        If GROUP_CD <> "全厂" And EMP_CD <> "当日" And MILL_STAND = "当日累计" Then
        
        For i = n3 To 0 Step -1

        If MILL_PASS_RATE = EMP3(i) Then

        .Text = i + 1

        End If
        
         Next i
        
        End If
        
           
     '4
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "<23" Then
        
        For i = n4 To 0 Step -1

        If MILL_PASS_RATE = EMP4(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
         '5
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = ">=23" Then

        
        For i = n5 To 0 Step -1

        If MILL_PASS_RATE = EMP5(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        '6
        If GROUP_CD <> "全厂" And EMP_CD = "当日" And MILL_STAND = "当日累计" Then

        
        For i = n6 To 0 Step -1

        If MILL_PASS_RATE = EMP6(i) Then
        
        .Text = i + 1
        
        End If
        
         Next i
        
        End If
        
        Next iCount
        
        End With
        
        
        
        
        
        Erase EMP1
        Erase EMP2
        Erase EMP3
        Erase EMP4
        Erase EMP5
        Erase EMP6
        n1 = 0
        n2 = 0
        n3 = 0
        n4 = 0
        n5 = 0
        n6 = 0
        
        
        
        
        With ss3
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        

        iRow = .MaxRows
        iRow = iRow - 1
        
        
        For iCount = 1 To iRow
        .ROW = iCount
        .Col = SS3_MILL_COUNT_Q345: STLGRT_WGT_Q345 = STLGRT_WGT_Q345 + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q345: STLGRT_PASS_WGT_Q345 = STLGRT_PASS_WGT_Q345 + Val(.Text)

        
                .Col = SS3_MILL_COUNT_Q390: STLGRT_WGT_Q390 = STLGRT_WGT_Q390 + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q390: STLGRT_PASS_WGT_Q390 = STLGRT_PASS_WGT_Q390 + Val(.Text)
        
                .Col = SS3_MILL_COUNT_Q460: STLGRT_WGT_Q460 = STLGRT_WGT_Q460 + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q460: STLGRT_PASS_WGT_Q460 = STLGRT_PASS_WGT_Q460 + Val(.Text)
        
                .Col = SS3_MILL_COUNT_AD: STLGRT_WGT_AD = STLGRT_WGT_AD + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_AD: STLGRT_PASS_WGT_AD = STLGRT_PASS_WGT_AD + Val(.Text)
        
        .Col = SS3_MILL_COUNT_R: STLGRT_WGT_R = STLGRT_WGT_R + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_R: STLGRT_PASS_WGT_R = STLGRT_PASS_WGT_R + Val(.Text)
        
                .Col = SS3_MILL_COUNT_X: STLGRT_WGT_X = STLGRT_WGT_X + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_X: STLGRT_PASS_WGT_X = STLGRT_PASS_WGT_X + Val(.Text)
        
                .Col = SS3_MILL_COUNT_Q235: STLGRT_WGT_Q235 = STLGRT_WGT_Q235 + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q235: STLGRT_PASS_WGT_Q235 = STLGRT_PASS_WGT_Q235 + Val(.Text)
        
                .Col = SS3_MILL_COUNT_A36: STLGRT_WGT_A36 = STLGRT_WGT_A36 + Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_A36: STLGRT_PASS_WGT_A36 = STLGRT_PASS_WGT_A36 + Val(.Text)
        
        
        
        Next iCount
        
        .ROW = .MaxRows
        
        .Col = SS3_GROUP_CD: .Text = "全厂"
        .Col = SS3_EMP_CD:   .Text = "当日"
        .Col = SS3_MILL_COUNT_Q345: .Text = STLGRT_WGT_Q345
        .Col = SS3_MILL_PASS_COUNT_Q345: .Text = STLGRT_PASS_WGT_Q345
        
        .Col = SS3_MILL_COUNT_Q390: .Text = STLGRT_WGT_Q390
        .Col = SS3_MILL_PASS_COUNT_Q390: .Text = STLGRT_PASS_WGT_Q390
        
        .Col = SS3_MILL_COUNT_Q460: .Text = STLGRT_WGT_Q460
        .Col = SS3_MILL_PASS_COUNT_Q460: .Text = STLGRT_PASS_WGT_Q460
        
                .Col = SS3_MILL_COUNT_AD: .Text = STLGRT_WGT_AD
        .Col = SS3_MILL_PASS_COUNT_AD: .Text = STLGRT_PASS_WGT_AD
        
                .Col = SS3_MILL_COUNT_R: .Text = STLGRT_WGT_R
        .Col = SS3_MILL_PASS_COUNT_R: .Text = STLGRT_PASS_WGT_R
        
                .Col = SS3_MILL_COUNT_X: .Text = STLGRT_WGT_X
        .Col = SS3_MILL_PASS_COUNT_X: .Text = STLGRT_PASS_WGT_X
        
        .Col = SS3_MILL_COUNT_Q235: .Text = STLGRT_WGT_Q235
        .Col = SS3_MILL_PASS_COUNT_Q235: .Text = STLGRT_PASS_WGT_Q235
        
        .Col = SS3_MILL_COUNT_A36: .Text = STLGRT_WGT_A36
        .Col = SS3_MILL_PASS_COUNT_A36: .Text = STLGRT_PASS_WGT_A36
        
        
        
        For iCount = 1 To .MaxRows
        
        .ROW = iCount
        
        .Col = SS3_MILL_COUNT_Q345: STLGRT_WGT_Q345 = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q345: STLGRT_PASS_WGT_Q345 = Val(.Text)
        
        If STLGRT_WGT_Q345 > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_Q345: .Text = STLGRT_PASS_WGT_Q345 / STLGRT_WGT_Q345 * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_Q345: .Text = 0
        
        
        End If
        

        
        .Col = SS3_MILL_COUNT_Q390: STLGRT_WGT_Q390 = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q390: STLGRT_PASS_WGT_Q390 = Val(.Text)
        
         If STLGRT_WGT_Q390 > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_Q390: .Text = STLGRT_PASS_WGT_Q390 / STLGRT_WGT_Q390 * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_Q390: .Text = 0
        
        
        End If
        
        .Col = SS3_MILL_COUNT_Q460: STLGRT_WGT_Q460 = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q460: STLGRT_PASS_WGT_Q460 = Val(.Text)
        
         If STLGRT_WGT_Q460 > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_Q460: .Text = STLGRT_PASS_WGT_Q460 / STLGRT_WGT_Q460 * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_Q460: .Text = 0
        
        
        End If
        
        .Col = SS3_MILL_COUNT_AD: STLGRT_WGT_AD = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_AD: STLGRT_PASS_WGT_AD = Val(.Text)
        
        
         If STLGRT_WGT_AD > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_AD: .Text = STLGRT_PASS_WGT_AD / STLGRT_WGT_AD * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_AD: .Text = 0
        
        
        End If
        
        .Col = SS3_MILL_COUNT_R: STLGRT_WGT_R = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_R: STLGRT_PASS_WGT_R = Val(.Text)
        
         If STLGRT_WGT_R > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_R: .Text = STLGRT_PASS_WGT_R / STLGRT_WGT_R * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_R: .Text = 0
        
        End If
        
        
        .Col = SS3_MILL_COUNT_X: STLGRT_WGT_X = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_X: STLGRT_PASS_WGT_X = Val(.Text)
        
        
         If STLGRT_WGT_X > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_X: .Text = STLGRT_PASS_WGT_X / STLGRT_WGT_X * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_X: .Text = 0
        
        
        End If
        
        .Col = SS3_MILL_COUNT_Q235: STLGRT_WGT_Q235 = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_Q235: STLGRT_PASS_WGT_Q235 = Val(.Text)
        
        
         If STLGRT_WGT_Q235 > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_Q235: .Text = STLGRT_PASS_WGT_Q235 / STLGRT_WGT_Q235 * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_Q235: .Text = 0
        
        
        End If
        
        
        
        .Col = SS3_MILL_COUNT_A36: STLGRT_WGT_A36 = Val(.Text)
        .Col = SS3_MILL_PASS_COUNT_A36: STLGRT_PASS_WGT_A36 = Val(.Text)
        
         If STLGRT_WGT_A36 > 0 Then
        
         .Col = SS3_MILL_PASS_RATE_A36: .Text = STLGRT_PASS_WGT_A36 / STLGRT_WGT_A36 * 100
        
        Else
        
        .Col = SS3_MILL_PASS_RATE_A36: .Text = 0
        
        
        End If
        
        
        Next iCount
        
        
        iRow = .MaxRows
        iRow = iRow - 1
        
        For iCount = 1 To iRow

        .ROW = iCount
        
        .Col = SS3_MILL_PASS_RATE_Q345
        EMP1(n1) = Val(.Text)
        n1 = n1 + 1
        
        .Col = SS3_MILL_PASS_RATE_Q390
        EMP2(n2) = Val(.Text)
        n2 = n2 + 1
        
        .Col = SS3_MILL_PASS_RATE_Q460
        EMP3(n3) = Val(.Text)
        n3 = n3 + 1
        
        .Col = SS3_MILL_PASS_RATE_AD
        EMP4(n4) = Val(.Text)
        n4 = n4 + 1
        
        .Col = SS3_MILL_PASS_RATE_R
        EMP5(n5) = Val(.Text)
        n5 = n5 + 1
        
        .Col = SS3_MILL_PASS_RATE_X
        EMP6(n6) = Val(.Text)
        n6 = n6 + 1
        
        .Col = SS3_MILL_PASS_RATE_Q235
        EMP7(n7) = Val(.Text)
        n7 = n7 + 1
        
        .Col = SS3_MILL_PASS_RATE_A36
        EMP8(n8) = Val(.Text)
        n8 = n8 + 1
        
        Next iCount
        
        For i = 0 To n1 - 2
        For j = 0 To n1 - 2 - i
        
        If EMP1(j) < EMP1(j + 1) Then
        
       temp1 = EMP1(j + 1): EMP1(j + 1) = EMP1(j): EMP1(j) = temp1
       
       End If
       
       If EMP2(j) < EMP2(j + 1) Then
       temp1 = EMP2(j + 1): EMP2(j + 1) = EMP2(j): EMP2(j) = temp1
       End If
       
       If EMP3(j) < EMP3(j + 1) Then
       temp1 = EMP3(j + 1): EMP3(j + 1) = EMP3(j): EMP3(j) = temp1
       End If
       
       If EMP4(j) < EMP4(j + 1) Then
       temp1 = EMP4(j + 1): EMP4(j + 1) = EMP4(j): EMP4(j) = temp1
       End If
       
       If EMP5(j) < EMP5(j + 1) Then
       temp1 = EMP5(j + 1): EMP5(j + 1) = EMP5(j): EMP5(j) = temp1
       End If
       
       If EMP6(j) < EMP6(j + 1) Then
       temp1 = EMP6(j + 1): EMP6(j + 1) = EMP6(j): EMP6(j) = temp1
       End If
       
       
       If EMP7(j) < EMP7(j + 1) Then
       temp1 = EMP7(j + 1): EMP7(j + 1) = EMP7(j): EMP7(j) = temp1
       End If
       
       
       If EMP8(j) < EMP8(j + 1) Then
       temp1 = EMP8(j + 1): EMP8(j + 1) = EMP8(j): EMP8(j) = temp1
       End If
        
        Next j
        
        Next i
        
        
       iCount = 1
       
       For iCount = 1 To iRow
       
       .ROW = iCount
       
       .Col = SS3_MILL_PASS_RATE_Q345: MILL_PASS_RATE_Q345 = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_Q390: MILL_PASS_RATE_Q390 = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_Q460: MILL_PASS_RATE_Q460 = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_AD: MILL_PASS_RATE_AD = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_R: MILL_PASS_RATE_R = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_X: MILL_PASS_RATE_X = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_Q235: MILL_PASS_RATE_Q235 = Val(.Text)
       .Col = SS3_MILL_PASS_RATE_A36: MILL_PASS_RATE_A36 = Val(.Text)
       
       
       For i = n1 To 0 Step -1
       
       If MILL_PASS_RATE_Q345 > 0 And MILL_PASS_RATE_Q345 = EMP1(i) Then
       
       .Col = SS3_MILL_RAKING_Q345: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q390 > 0 And MILL_PASS_RATE_Q390 = EMP2(i) Then
       
       .Col = SS3_MILL_RAKING_Q390: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q460 > 0 And MILL_PASS_RATE_Q460 = EMP3(i) Then
       
       .Col = SS3_MILL_RAKING_Q460: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_AD > 0 And MILL_PASS_RATE_AD = EMP4(i) Then
       
       .Col = SS3_MILL_RAKING_AD: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_R > 0 And MILL_PASS_RATE_R = EMP5(i) Then
       
       .Col = SS3_MILL_RAKING_R: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_X > 0 And MILL_PASS_RATE_X = EMP6(i) Then
       
       .Col = SS3_MILL_RAKING_X: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q235 > 0 And MILL_PASS_RATE_Q235 = EMP7(i) Then
       
       .Col = SS3_MILL_RAKING_Q235: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_A36 > 0 And MILL_PASS_RATE_A36 = EMP8(i) Then
       
       .Col = SS3_MILL_RAKING_A36: .Text = i + 1
       
       End If
       
       Next i
       
    
       Next iCount
       
        
            
        
        
        
        
        
        
        
        
        
        End With
        
        
         Erase EMP1
        Erase EMP2
        Erase EMP3
        Erase EMP4
        Erase EMP5
        Erase EMP6
        Erase EMP7
        Erase EMP8
        n1 = 0
        n2 = 0
        n3 = 0
        n4 = 0
        n5 = 0
        n6 = 0
        n7 = 0
        n8 = 0
        
        STLGRT_WGT_Q345 = 0
        STLGRT_PASS_WGT_Q345 = 0
        STLGRT_WGT_Q390 = 0
        STLGRT_PASS_WGT_Q390 = 0
        STLGRT_WGT_Q460 = 0
        STLGRT_PASS_WGT_Q460 = 0
        STLGRT_WGT_AD = 0
        STLGRT_PASS_WGT_AD = 0
        STLGRT_WGT_R = 0
        STLGRT_PASS_WGT_R = 0
        STLGRT_WGT_X = 0
        STLGRT_PASS_WGT_X = 0
        STLGRT_WGT_Q235 = 0
        STLGRT_PASS_WGT_Q235 = 0
        STLGRT_WGT_A36 = 0
        STLGRT_PASS_WGT_A36 = 0
        
        With ss4
        
        .ROW = .MaxRows
        .ReDraw = False
        .Action = 0
        .EditMode = False: .MaxRows = .MaxRows + 1
        
         .ROW = .ROW + 1
        .Action = 7
        .ReDraw = True
        

        iRow = .MaxRows
        iRow = iRow - 1
        
        
        For iCount = 1 To iRow
        .ROW = iCount
        .Col = SS4_MILL_COUNT_Q345: STLGRT_WGT_Q345 = STLGRT_WGT_Q345 + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q345: STLGRT_PASS_WGT_Q345 = STLGRT_PASS_WGT_Q345 + Val(.Text)

        
                .Col = SS4_MILL_COUNT_Q390: STLGRT_WGT_Q390 = STLGRT_WGT_Q390 + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q390: STLGRT_PASS_WGT_Q390 = STLGRT_PASS_WGT_Q390 + Val(.Text)
        
                .Col = SS4_MILL_COUNT_Q460: STLGRT_WGT_Q460 = STLGRT_WGT_Q460 + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q460: STLGRT_PASS_WGT_Q460 = STLGRT_PASS_WGT_Q460 + Val(.Text)
        
                .Col = SS4_MILL_COUNT_AD: STLGRT_WGT_AD = STLGRT_WGT_AD + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_AD: STLGRT_PASS_WGT_AD = STLGRT_PASS_WGT_AD + Val(.Text)
        
        .Col = SS4_MILL_COUNT_R: STLGRT_WGT_R = STLGRT_WGT_R + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_R: STLGRT_PASS_WGT_R = STLGRT_PASS_WGT_R + Val(.Text)
        
                .Col = SS4_MILL_COUNT_X: STLGRT_WGT_X = STLGRT_WGT_X + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_X: STLGRT_PASS_WGT_X = STLGRT_PASS_WGT_X + Val(.Text)
        
                .Col = SS4_MILL_COUNT_Q235: STLGRT_WGT_Q235 = STLGRT_WGT_Q235 + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q235: STLGRT_PASS_WGT_Q235 = STLGRT_PASS_WGT_Q235 + Val(.Text)
        
                .Col = SS4_MILL_COUNT_A36: STLGRT_WGT_A36 = STLGRT_WGT_A36 + Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_A36: STLGRT_PASS_WGT_A36 = STLGRT_PASS_WGT_A36 + Val(.Text)
        
        
        
        Next iCount
        
        .ROW = .MaxRows
        
        .Col = SS4_GROUP_CD: .Text = "全厂"
        .Col = SS4_EMP_CD:   .Text = "当日"
        .Col = SS4_MILL_COUNT_Q345: .Text = STLGRT_WGT_Q345
        .Col = SS4_MILL_PASS_COUNT_Q345: .Text = STLGRT_PASS_WGT_Q345
        
        .Col = SS4_MILL_COUNT_Q390: .Text = STLGRT_WGT_Q390
        .Col = SS4_MILL_PASS_COUNT_Q390: .Text = STLGRT_PASS_WGT_Q390
        
        .Col = SS4_MILL_COUNT_Q460: .Text = STLGRT_WGT_Q460
        .Col = SS4_MILL_PASS_COUNT_Q460: .Text = STLGRT_PASS_WGT_Q460
        
                .Col = SS4_MILL_COUNT_AD: .Text = STLGRT_WGT_AD
        .Col = SS4_MILL_PASS_COUNT_AD: .Text = STLGRT_PASS_WGT_AD
        
                .Col = SS4_MILL_COUNT_R: .Text = STLGRT_WGT_R
        .Col = SS4_MILL_PASS_COUNT_R: .Text = STLGRT_PASS_WGT_R
        
                .Col = SS4_MILL_COUNT_X: .Text = STLGRT_WGT_X
        .Col = SS4_MILL_PASS_COUNT_X: .Text = STLGRT_PASS_WGT_X
        
        .Col = SS4_MILL_COUNT_Q235: .Text = STLGRT_WGT_Q235
        .Col = SS4_MILL_PASS_COUNT_Q235: .Text = STLGRT_PASS_WGT_Q235
        
        .Col = SS4_MILL_COUNT_A36: .Text = STLGRT_WGT_A36
        .Col = SS4_MILL_PASS_COUNT_A36: .Text = STLGRT_PASS_WGT_A36
        
        
        
        For iCount = 1 To .MaxRows
        
        .ROW = iCount
        
        .Col = SS4_MILL_COUNT_Q345: STLGRT_WGT_Q345 = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q345: STLGRT_PASS_WGT_Q345 = Val(.Text)
        
        If STLGRT_WGT_Q345 > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_Q345: .Text = STLGRT_PASS_WGT_Q345 / STLGRT_WGT_Q345 * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_Q345: .Text = 0
        
        
        End If
        

        
        .Col = SS4_MILL_COUNT_Q390: STLGRT_WGT_Q390 = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q390: STLGRT_PASS_WGT_Q390 = Val(.Text)
        
         If STLGRT_WGT_Q390 > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_Q390: .Text = STLGRT_PASS_WGT_Q390 / STLGRT_WGT_Q390 * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_Q390: .Text = 0
        
        
        End If
        
        .Col = SS4_MILL_COUNT_Q460: STLGRT_WGT_Q460 = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q460: STLGRT_PASS_WGT_Q460 = Val(.Text)
        
         If STLGRT_WGT_Q460 > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_Q460: .Text = STLGRT_PASS_WGT_Q460 / STLGRT_WGT_Q460 * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_Q460: .Text = 0
        
        
        End If
        
        .Col = SS4_MILL_COUNT_AD: STLGRT_WGT_AD = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_AD: STLGRT_PASS_WGT_AD = Val(.Text)
        
        
         If STLGRT_WGT_AD > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_AD: .Text = STLGRT_PASS_WGT_AD / STLGRT_WGT_AD * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_AD: .Text = 0
        
        
        End If
        
        .Col = SS4_MILL_COUNT_R: STLGRT_WGT_R = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_R: STLGRT_PASS_WGT_R = Val(.Text)
        
         If STLGRT_WGT_R > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_R: .Text = STLGRT_PASS_WGT_R / STLGRT_WGT_R * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_R: .Text = 0
        
        End If
        
        
        .Col = SS4_MILL_COUNT_X: STLGRT_WGT_X = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_X: STLGRT_PASS_WGT_X = Val(.Text)
        
        
         If STLGRT_WGT_X > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_X: .Text = STLGRT_PASS_WGT_X / STLGRT_WGT_X * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_X: .Text = 0
        
        
        End If
        
        .Col = SS4_MILL_COUNT_Q235: STLGRT_WGT_Q235 = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_Q235: STLGRT_PASS_WGT_Q235 = Val(.Text)
        
        
         If STLGRT_WGT_Q235 > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_Q235: .Text = STLGRT_PASS_WGT_Q235 / STLGRT_WGT_Q235 * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_Q235: .Text = 0
        
        
        End If
        
        
        
        .Col = SS4_MILL_COUNT_A36: STLGRT_WGT_A36 = Val(.Text)
        .Col = SS4_MILL_PASS_COUNT_A36: STLGRT_PASS_WGT_A36 = Val(.Text)
        
         If STLGRT_WGT_A36 > 0 Then
        
         .Col = SS4_MILL_PASS_RATE_A36: .Text = STLGRT_PASS_WGT_A36 / STLGRT_WGT_A36 * 100
        
        Else
        
        .Col = SS4_MILL_PASS_RATE_A36: .Text = 0
        
        
        End If
        
        
        Next iCount
        
        
        iRow = .MaxRows
        iRow = iRow - 1
        
        For iCount = 1 To iRow

        .ROW = iCount
        
        .Col = SS4_MILL_PASS_RATE_Q345
        EMP1(n1) = Val(.Text)
        n1 = n1 + 1
        
        .Col = SS4_MILL_PASS_RATE_Q390
        EMP2(n2) = Val(.Text)
        n2 = n2 + 1
        
        .Col = SS4_MILL_PASS_RATE_Q460
        EMP3(n3) = Val(.Text)
        n3 = n3 + 1
        
        .Col = SS4_MILL_PASS_RATE_AD
        EMP4(n4) = Val(.Text)
        n4 = n4 + 1
        
        .Col = SS4_MILL_PASS_RATE_R
        EMP5(n5) = Val(.Text)
        n5 = n5 + 1
        
        .Col = SS4_MILL_PASS_RATE_X
        EMP6(n6) = Val(.Text)
        n6 = n6 + 1
        
        .Col = SS4_MILL_PASS_RATE_Q235
        EMP7(n7) = Val(.Text)
        n7 = n7 + 1
        
        .Col = SS4_MILL_PASS_RATE_A36
        EMP8(n8) = Val(.Text)
        n8 = n8 + 1
        
        Next iCount
        
        For i = 0 To n1 - 2
        For j = 0 To n1 - 2 - i
        
        If EMP1(j) < EMP1(j + 1) Then
        
       temp1 = EMP1(j + 1): EMP1(j + 1) = EMP1(j): EMP1(j) = temp1
       
       End If
       
       If EMP2(j) < EMP2(j + 1) Then
       temp1 = EMP2(j + 1): EMP2(j + 1) = EMP2(j): EMP2(j) = temp1
       End If
       
       If EMP3(j) < EMP3(j + 1) Then
       temp1 = EMP3(j + 1): EMP3(j + 1) = EMP3(j): EMP3(j) = temp1
       End If
       
       If EMP4(j) < EMP4(j + 1) Then
       temp1 = EMP4(j + 1): EMP4(j + 1) = EMP4(j): EMP4(j) = temp1
       End If
       
       If EMP5(j) < EMP5(j + 1) Then
       temp1 = EMP5(j + 1): EMP5(j + 1) = EMP5(j): EMP5(j) = temp1
       End If
       
       If EMP6(j) < EMP6(j + 1) Then
       temp1 = EMP6(j + 1): EMP6(j + 1) = EMP6(j): EMP6(j) = temp1
       End If
       
       
       If EMP7(j) < EMP7(j + 1) Then
       temp1 = EMP7(j + 1): EMP7(j + 1) = EMP7(j): EMP7(j) = temp1
       End If
       
       
       If EMP8(j) < EMP8(j + 1) Then
       temp1 = EMP8(j + 1): EMP8(j + 1) = EMP8(j): EMP8(j) = temp1
       End If
        
        Next j
        
        Next i
        
        
       iCount = 1
       
       For iCount = 1 To iRow
       
       .ROW = iCount
       
       .Col = SS4_MILL_PASS_RATE_Q345: MILL_PASS_RATE_Q345 = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_Q390: MILL_PASS_RATE_Q390 = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_Q460: MILL_PASS_RATE_Q460 = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_AD: MILL_PASS_RATE_AD = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_R: MILL_PASS_RATE_R = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_X: MILL_PASS_RATE_X = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_Q235: MILL_PASS_RATE_Q235 = Val(.Text)
       .Col = SS4_MILL_PASS_RATE_A36: MILL_PASS_RATE_A36 = Val(.Text)
       
       
       For i = n1 To 0 Step -1
       
       If MILL_PASS_RATE_Q345 > 0 And MILL_PASS_RATE_Q345 = EMP1(i) Then
       
       .Col = SS4_MILL_RAKING_Q345: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q390 > 0 And MILL_PASS_RATE_Q390 = EMP2(i) Then
       
       .Col = SS4_MILL_RAKING_Q390: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q460 > 0 And MILL_PASS_RATE_Q460 = EMP3(i) Then
       
       .Col = SS4_MILL_RAKING_Q460: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_AD > 0 And MILL_PASS_RATE_AD = EMP4(i) Then
       
       .Col = SS4_MILL_RAKING_AD: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_R > 0 And MILL_PASS_RATE_R = EMP5(i) Then
       
       .Col = SS4_MILL_RAKING_R: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_X > 0 And MILL_PASS_RATE_X = EMP6(i) Then
       
       .Col = SS4_MILL_RAKING_X: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_Q235 > 0 And MILL_PASS_RATE_Q235 = EMP7(i) Then
       
       .Col = SS4_MILL_RAKING_Q235: .Text = i + 1
       
       End If
       
       If MILL_PASS_RATE_A36 > 0 And MILL_PASS_RATE_A36 = EMP8(i) Then
       
       .Col = SS4_MILL_RAKING_A36: .Text = i + 1
       
       End If
       
       Next i
       
    
       Next iCount
       
        
            
        
        
        
        
        
        
        
        
        
        End With
        
        
        
        
        
        Call MDIMain.FormMenuSetting(Me, FormType, "RE", sAuthority)
        
        MDIMain.MenuTool.Buttons(4).Enabled = True
        MDIMain.MenuTool.Buttons(7).Enabled = False
        MDIMain.MenuTool.Buttons(8).Enabled = False
        MDIMain.MenuTool.Buttons(9).Enabled = False
        MDIMain.MenuTool.Buttons(11).Enabled = False
        MDIMain.MenuTool.Buttons(12).Enabled = False
        
End Sub


Public Sub Spread_ColumnsSort()

    Spread_ColSort.Show 1
    
End Sub

Public Sub Form_Exc()


      If txt_shape.Text = "ss1" Then
        Call Gp_Sp_Excel(Me, Proc_Sc("Sc1")("Spread"), lBlkcol1, lBlkcol2, lBlkrow1, lBlkrow2)
        ElseIf txt_shape.Text = "ss2" Then
        Call Gp_Sp_Excel(Me, Proc_Sc("Sc2")("Spread"), lBlkcol1, lBlkcol2, lBlkrow1, lBlkrow2)
        ElseIf txt_shape.Text = "ss3" Then
        Call Gp_Sp_Excel(Me, Proc_Sc("Sc3")("Spread"), lBlkcol1, lBlkcol2, lBlkrow1, lBlkrow2)
        ElseIf txt_shape.Text = "ss4" Then
        Call Gp_Sp_Excel(Me, Proc_Sc("Sc4")("Spread"), lBlkcol1, lBlkcol2, lBlkrow1, lBlkrow2)
      End If
      
End Sub

Public Sub Form_Exit()
    Unload Me
End Sub

Private Sub ss1_Click(ByVal Col As Long, ByVal ROW As Long)
txt_shape.Text = "ss1"
End Sub



Private Sub ss2_Click(ByVal Col As Long, ByVal ROW As Long)
txt_shape.Text = "ss2"
End Sub


Private Sub ss3_Click(ByVal Col As Long, ByVal ROW As Long)
txt_shape.Text = "ss3"
End Sub


Private Sub ss4_Click(ByVal Col As Long, ByVal ROW As Long)
txt_shape.Text = "ss4"
End Sub
