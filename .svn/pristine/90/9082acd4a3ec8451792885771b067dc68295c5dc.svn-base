VERSION 5.00
Object = "{065E6FD1-1BF9-11D2-BAE8-00104B9E0792}#3.0#0"; "ssa3d30.ocx"
Object = "{FDAC2480-F4ED-4632-AA78-DCA210A74E49}#6.0#0"; "SPR32X60.ocx"
Object = "{D1F54538-FC6B-4AC6-9655-2FB5170110A8}#1.0#0"; "Indate.ocx"
Object = "{8C3D4AA0-2599-11D2-BAF1-00104B9E0792}#3.0#0"; "sssplt30.ocx"
Begin VB.Form AQC0095C 
   Caption         =   "板坯低倍试样接收_AQC0095C"
   ClientHeight    =   3120
   ClientLeft      =   60
   ClientTop       =   420
   ClientWidth     =   4680
   LinkTopic       =   "Form1"
   MDIChild        =   -1  'True
   ScaleHeight     =   3120
   ScaleWidth      =   4680
   WindowState     =   2  'Maximized
   Begin SSSplitter.SSSplitter SSSplitter1 
      Height          =   9135
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   15495
      _ExtentX        =   27331
      _ExtentY        =   16113
      _Version        =   196609
      PaneTree        =   "AQC0095C.frx":0000
      Begin FPSpread.vaSpread ss1 
         Height          =   7890
         Left            =   30
         TabIndex        =   1
         Top             =   1215
         Width           =   15435
         _Version        =   393216
         _ExtentX        =   27226
         _ExtentY        =   13917
         _StockProps     =   64
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         MaxCols         =   40
         MaxRows         =   1
         RetainSelBlock  =   0   'False
         SpreadDesigner  =   "AQC0095C.frx":0052
      End
      Begin Threed.SSPanel SSPanel1 
         Height          =   1095
         Left            =   30
         TabIndex        =   2
         Top             =   30
         Width           =   15435
         _ExtentX        =   27226
         _ExtentY        =   1931
         _Version        =   196609
         RoundedCorners  =   0   'False
         FloodShowPct    =   -1  'True
         Begin VB.TextBox txt_STLGRD 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   310
            Left            =   9120
            MaxLength       =   18
            TabIndex        =   12
            Top             =   120
            Width           =   1575
         End
         Begin VB.TextBox txt_CAST_CNT 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   310
            Left            =   3390
            MaxLength       =   18
            TabIndex        =   9
            Top             =   600
            Width           =   375
         End
         Begin VB.TextBox txt_CAST_NO 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   310
            Left            =   1560
            MaxLength       =   18
            TabIndex        =   8
            Top             =   600
            Width           =   1455
         End
         Begin VB.TextBox txt_TRUSTDEED_NO 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   310
            Left            =   6480
            MaxLength       =   18
            TabIndex        =   7
            Top             =   600
            Width           =   1215
         End
         Begin VB.CheckBox txt_SMP_PROCESS 
            Height          =   180
            Left            =   11160
            TabIndex        =   6
            Top             =   720
            Width           =   180
         End
         Begin VB.TextBox txt_SMP_NO 
            BackColor       =   &H00FFFFFF&
            BeginProperty Font 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   310
            Left            =   9120
            MaxLength       =   18
            TabIndex        =   5
            Top             =   600
            Width           =   1575
         End
         Begin VB.ComboBox txt_TEST_TYPE 
            Height          =   300
            ItemData        =   "AQC0095C.frx":0AF4
            Left            =   13920
            List            =   "AQC0095C.frx":0B04
            TabIndex        =   4
            Top             =   600
            Visible         =   0   'False
            Width           =   1335
         End
         Begin VB.ComboBox txt_PRC_LINE 
            Height          =   300
            ItemData        =   "AQC0095C.frx":0B30
            Left            =   6480
            List            =   "AQC0095C.frx":0B3D
            TabIndex        =   3
            Top             =   120
            Width           =   615
         End
         Begin InDate.ULabel ULabel3 
            Height          =   315
            Index           =   0
            Left            =   8040
            Top             =   600
            Width           =   1065
            _ExtentX        =   1879
            _ExtentY        =   556
            Caption         =   "试样号"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel4 
            Height          =   315
            Index           =   3
            Left            =   11400
            Top             =   600
            Width           =   1185
            _ExtentX        =   2090
            _ExtentY        =   556
            Caption         =   "已接收"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel3 
            Height          =   315
            Index           =   2
            Left            =   240
            Top             =   120
            Width           =   1305
            _ExtentX        =   2302
            _ExtentY        =   556
            Caption         =   "录入日期"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   16711680
         End
         Begin InDate.UDate from_date 
            Height          =   315
            Left            =   1560
            TabIndex        =   10
            Tag             =   "发放日期"
            Top             =   120
            Width           =   1500
            _ExtentX        =   2646
            _ExtentY        =   556
            Text            =   "2016-12-23"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.74
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   -2147483630
            BackColor       =   16777215
            RawData         =   "20161223"
         End
         Begin InDate.UDate to_date 
            Height          =   315
            Left            =   3390
            TabIndex        =   11
            Tag             =   "发放日期"
            Top             =   120
            Width           =   1500
            _ExtentX        =   2646
            _ExtentY        =   556
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.74
               Charset         =   134
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   -2147483630
            BackColor       =   16777215
         End
         Begin InDate.ULabel ULabel6 
            Height          =   315
            Left            =   3090
            Top             =   120
            Width           =   225
            _ExtentX        =   397
            _ExtentY        =   556
            Caption         =   "-"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   -2147483647
         End
         Begin InDate.ULabel ULabel3 
            Height          =   315
            Index           =   3
            Left            =   5280
            Top             =   600
            Width           =   1185
            _ExtentX        =   2090
            _ExtentY        =   556
            Caption         =   "委托单号"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel3 
            Height          =   315
            Index           =   4
            Left            =   5280
            Top             =   120
            Width           =   1185
            _ExtentX        =   2090
            _ExtentY        =   556
            Caption         =   "铸机号"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel4 
            Height          =   315
            Index           =   4
            Left            =   8040
            Top             =   120
            Width           =   1065
            _ExtentX        =   1879
            _ExtentY        =   556
            Caption         =   "钢种"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel4 
            Height          =   315
            Index           =   2
            Left            =   240
            Top             =   600
            Width           =   1305
            _ExtentX        =   2302
            _ExtentY        =   556
            Caption         =   "浇次号"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel4 
            Height          =   315
            Index           =   0
            Left            =   3075
            Top             =   600
            Width           =   225
            _ExtentX        =   397
            _ExtentY        =   556
            Caption         =   "-"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
         Begin InDate.ULabel ULabel3 
            Height          =   315
            Index           =   1
            Left            =   12720
            Top             =   600
            Visible         =   0   'False
            Width           =   1185
            _ExtentX        =   2090
            _ExtentY        =   556
            Caption         =   "试验种类"
            Alignment       =   1
            BackColor       =   14804173
            BackgroundStyle =   1
            ChiselText      =   2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "宋体"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   0
         End
      End
   End
End
Attribute VB_Name = "AQC0095C"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Public sAuthority As String
Public FormType As String
Public Toolbar_St As String

Dim Mc1 As New Collection
Dim Sc1 As New Collection
Dim Proc_Sc As New Collection

Dim pControl As New Collection
Dim nControl As New Collection
Dim mControl As New Collection
Dim iControl As New Collection
Dim rControl As New Collection
Dim cControl As New Collection
Dim aControl As New Collection
Dim lControl As New Collection

Dim pColumn1 As New Collection
Dim nColumn1 As New Collection
Dim mColumn1 As New Collection
Dim iColumn1 As New Collection
Dim aColumn1 As New Collection
Dim lColumn1 As New Collection

Dim lBlkcol1 As Long                'To Excel Block Col1
Dim lBlkcol2 As Long                'To Excel Block Col2
Dim lBlkrow1 As Long                'To Excel Block Row1
Dim lBlkrow2 As Long                'To Excel Block Row2

Private xlApp       As Object   'Execel object
Private xlSheet     As Object   'Execel Sheet object





Private Sub Form_Load()
  sAuthority = Gf_Pgm_Authority(Me.Name)
  
  Call Form_Define
  
  Call MDIMain.FormMenuSetting(Me, FormType, "FS", sAuthority)
  
  Call Gp_Ms_Cls(Mc1("rControl"))
  Call Gp_Ms_NeceColor(Mc1("nControl"))
  
  Call Gp_Sp_Setting(Proc_Sc("Sc")("Spread"))
  Call Gf_Sp_Cls(Proc_Sc("Sc"))
  Call Gp_Sp_ColGet(Proc_Sc("Sc")("Spread"), "F-System.INI", Me.Name)
  
End Sub

Private Sub Form_Define()
  FormType = "Msheet"
  
  'Call Master_Collection("Control_Name", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "r(refer)", "a(append)", "l(lock)")
  Call Gp_Ms_Collection(from_date, "p", "n", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(to_date, "p", "n", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_TRUSTDEED_NO, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_PRC_LINE, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_CAST_NO, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_CAST_CNT, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_SMP_NO, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_TEST_TYPE, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_STLGRD, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  Call Gp_Ms_Collection(txt_SMP_PROCESS, "p", " ", "", "", "r", "", "", pControl, nControl, mControl, iControl, rControl, aControl, lControl)
  
  Mc1.Add Item:=pControl, Key:="pControl"
  Mc1.Add Item:=nControl, Key:="nControl"
  Mc1.Add Item:=mControl, Key:="mControl"
  Mc1.Add Item:=iControl, Key:="iControl"
  Mc1.Add Item:=rControl, Key:="rControl"
  Mc1.Add Item:=cControl, Key:="cControl"
  Mc1.Add Item:=aControl, Key:="aControl"
  Mc1.Add Item:=lControl, Key:="lControl"
  
   'Call Spread_Collection("Column_Num", "p(primary)", "n(Necessary)", "m(maxlength)", "i(insert)", "a(append_down), "l(lock)")
  Call Gp_Sp_Collection(ss1, 1, "", "", "", " ", "", "", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 2, "", "", "", "i", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 3, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 4, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 5, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 6, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 7, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 8, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 9, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 10, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 11, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 12, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 13, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 14, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 15, "", "", "", "i", "", " ", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 16, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 17, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 18, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 19, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 20, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 21, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 22, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 23, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 24, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 25, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 26, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 27, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 28, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 29, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 30, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 31, "", "", "", " ", "", "", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 32, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 33, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 34, "", "", "", " ", "", " ", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 35, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 36, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 37, "", "", "", " ", "", " ", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 38, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 39, "", "", "", " ", "", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  Call Gp_Sp_Collection(ss1, 40, "", "", "", "i", "a", "l", pColumn1, nColumn1, mColumn1, iColumn1, aColumn1, lColumn1)
  
  Sc1.Add Item:=ss1, Key:="Spread"
  Sc1.Add Item:="AQC0095C.P_MODIFY", Key:="P-M"  '-----
  Sc1.Add Item:="AQC0095C.P_REFER", Key:="P-R"
  
  Sc1.Add Item:=pColumn1, Key:="pColumn"
  Sc1.Add Item:=nColumn1, Key:="nColumn"
  Sc1.Add Item:=aColumn1, Key:="aColumn"
  Sc1.Add Item:=mColumn1, Key:="mColumn"
  Sc1.Add Item:=iColumn1, Key:="iColumn"
  Sc1.Add Item:=lColumn1, Key:="lColumn"
   Sc1.Add Item:=1, Key:="First"
    Sc1.Add Item:=ss1.MaxCols, Key:="Last"
  Proc_Sc.Add Item:=Sc1, Key:="Sc"    '-----
  
  Sc1.Item("Spread").Col = 0  '给
  Sc1.Item("Spread").Row = 0
  Sc1.Item("Spread").Text = "◎"
  
  Me.KeyPreview = True
  Me.BackColor = &HE0E0E0
 ss1.ColsFrozen = 7

End Sub

Private Sub Form_Activate()

  Call MDIMain.FormMenuSetting(Me, FormType, Toolbar_St, sAuthority)
  MDIMain.MenuTool.Buttons(7).Enabled = False
    MDIMain.MenuTool.Buttons(8).Enabled = False
    MDIMain.MenuTool.Buttons(9).Enabled = False
    MDIMain.MenuTool.Buttons(10).Enabled = False
    MDIMain.MenuTool.Buttons(11).Enabled = False
    MDIMain.MenuTool.Buttons(12).Enabled = False
    MDIMain.MenuTool.Buttons(13).Enabled = False

End Sub



Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  
  Call Gp_Sp_ColSet(Proc_Sc("Sc")("Spread"), "Q-System.INI", Me.Name)
  Set pControl = Nothing
  Set nControl = Nothing
  Set iControl = Nothing
  Set rControl = Nothing
  Set cControl = Nothing
  Set aControl = Nothing
  Set lControl = Nothing
  Set mControl = Nothing
  
  Set iControl = Nothing
  Set pControl = Nothing
  Set lControl = Nothing
  Set nControl = Nothing
  Set mControl = Nothing
  Set aControl = Nothing
  
  Set Mc1 = Nothing
  Set Sc1 = Nothing
  Set Proc_Sc = Nothing
  
  Call MDIMain.FormMenuSetting(Me, "start", Toolbar_St, "")
    
  

End Sub

Public Sub Form_Ref()  '查询
  On Error GoTo Refer_Err
  If Gf_Sp_Refer(M_CN1, Proc_Sc("Sc"), Mc1, Mc1("nControl"), Mc1("mControl")) Then
    Call MDIMain.FormMenuSetting(Me, FormType, "RE", sAuthority)
    ss1.OperationMode = OperationModeNormal
    
    MDIMain.MenuTool.Buttons(7).Enabled = False
    MDIMain.MenuTool.Buttons(8).Enabled = False
    MDIMain.MenuTool.Buttons(9).Enabled = False
    MDIMain.MenuTool.Buttons(10).Enabled = False
    MDIMain.MenuTool.Buttons(11).Enabled = False
    MDIMain.MenuTool.Buttons(12).Enabled = False
    Exit Sub
  End If
Refer_Err:
End Sub

Public Sub Form_Pro()  '保存
    If txt_SMP_PROCESS = 0 Then
          
        If Gf_Sp_Process(M_CN1, Proc_Sc("Sc"), Mc1) Then
          Call MDIMain.FormMenuSetting(Me, FormType, "RE", sAuthority)
          
        End If
          MDIMain.MenuTool.Buttons(7).Enabled = False
          MDIMain.MenuTool.Buttons(8).Enabled = False
          MDIMain.MenuTool.Buttons(9).Enabled = False
          MDIMain.MenuTool.Buttons(10).Enabled = False
          MDIMain.MenuTool.Buttons(11).Enabled = False
          MDIMain.MenuTool.Buttons(12).Enabled = False
          MDIMain.MenuTool.Buttons(13).Enabled = False
    End If
End Sub

Private Sub ss1_EditMode(ByVal Col As Long, ByVal Row As Long, ByVal Mode As Integer, ByVal ChangeMade As Boolean)  '修改
  If Gf_Sc_Authority(sAuthority, "U") Then
    Call Gp_Sp_UpdateMake(Proc_Sc("Sc")("Spread"), Mode)
  End If
  With ss1
            .Col = 15
                .Row = ss1.ActiveRow
                .Text = sUserID
          End With
End Sub

Public Sub Form_Exc()  '导出数据到Excel
    
    Call Gp_Sp_Excel(Me, Proc_Sc("Sc")("Spread"), lBlkcol1, lBlkcol2, lBlkrow1, lBlkrow2)

End Sub

Public Sub Form_Exit()

    Unload Me
    
End Sub

Public Sub Form_Cls()
    
    If Gf_Sp_Cls(Proc_Sc("Sc")) Then
        Call Gp_Ms_Cls(Mc1("rControl"))
        Call MDIMain.FormMenuSetting(Me, FormType, "CLS", sAuthority)
        Call Gp_Ms_ControlLock(Mc1("lControl"), False)
        rControl(1).SetFocus
    End If
End Sub

